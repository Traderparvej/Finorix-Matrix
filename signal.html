<script>
// --- Admin Panel ---
let adminClickCount = 0;

// Hidden icon for admin panel
const adminIcon = document.createElement('div');
adminIcon.style.position = 'fixed';
adminIcon.style.bottom = '10px';
adminIcon.style.right = '10px';
adminIcon.style.width = '20px';
adminIcon.style.height = '20px';
adminIcon.style.background = '#0f0';
adminIcon.style.borderRadius = '50%';
adminIcon.style.cursor = 'pointer';
adminIcon.style.zIndex = '9999';
document.body.appendChild(adminIcon);

adminIcon.addEventListener('click', () => {
    adminClickCount++;
    if(adminClickCount >= 5){
        adminClickCount = 0;
        const pwd = prompt("Enter admin password:");
        if(pwd === "@TraderParvej@"){
            showAdminPanel();
        } else {
            alert("Incorrect password!");
        }
    }
});

function showAdminPanel(){
    const overlay = document.createElement('div');
    overlay.classList.add('adminPanelOverlay');
    overlay.style.position = 'fixed';
    overlay.style.top = '0';
    overlay.style.left = '0';
    overlay.style.width = '100%';
    overlay.style.height = '100%';
    overlay.style.background = 'rgba(0,0,0,0.95)';
    overlay.style.display = 'flex';
    overlay.style.flexDirection = 'column';
    overlay.style.justifyContent = 'center';
    overlay.style.alignItems = 'center';
    overlay.style.zIndex = '10000';
    overlay.style.color = '#0f0';
    overlay.style.fontFamily = "'Share Tech Mono', monospace";

    overlay.innerHTML = `
        <h2>ðŸ›¡ Admin Panel ðŸ›¡</h2>
        <input type="text" id="userQuotexID" placeholder="Quotex ID" style="width:250px;padding:10px;margin:10px 0;background:#000;border:1px solid #0f0;color:#0f0;border-radius:6px;font-size:14px;">
        <input type="number" id="licenseDays" placeholder="License Days" style="width:250px;padding:10px;margin:10px 0;background:#000;border:1px solid #0f0;color:#0f0;border-radius:6px;font-size:14px;">
        <button id="saveLicenseBtn" style="padding:10px 20px;margin-top:10px;background:linear-gradient(90deg,#00ff0f,#00cc8a);border:none;color:#000;font-weight:bold;border-radius:8px;cursor:pointer;">Save License</button>
        <button id="closeAdminBtn" style="padding:8px 15px;margin-top:10px;background:#000;border:1px solid #0f0;color:#0f0;border-radius:8px;cursor:pointer;">Close</button>
    `;

    document.body.appendChild(overlay);

    document.getElementById('closeAdminBtn').onclick = () => overlay.remove();

    document.getElementById('saveLicenseBtn').onclick = () => {
        const id = document.getElementById('userQuotexID').value.trim();
        const days = parseInt(document.getElementById('licenseDays').value);
        if(id && days){
            const expiry = new Date();
            expiry.setDate(expiry.getDate() + days);
            // Save in localStorage
            let licenses = JSON.parse(localStorage.getItem('licenses')||'{}');
            licenses[id] = expiry.getTime();
            localStorage.setItem('licenses', JSON.stringify(licenses));
            alert(`License for ${id} saved for ${days} days âœ…`);
        } else {
            alert("Fill all fields!");
        }
    }
}

// --- Modify License Popup to check localStorage ---
function showLicensePopup(){
    const overlay = document.createElement("div");
    overlay.style.position = "fixed";
    overlay.style.top = "0";
    overlay.style.left = "0";
    overlay.style.width = "100%";
    overlay.style.height = "100%";
    overlay.style.background = "rgba(0,0,0,0.9)";
    overlay.style.display = "flex";
    overlay.style.justifyContent = "center";
    overlay.style.alignItems = "center";
    overlay.style.zIndex = "9999";

    const box = document.createElement("div");
    box.style.background = "#000";
    box.style.border = "2px solid #0f0";
    box.style.padding = "30px";
    box.style.borderRadius = "12px";
    box.style.maxWidth = "400px";
    box.style.width = "90%";
    box.style.color = "#0f0";
    box.style.fontFamily = "'Share Tech Mono', monospace";
    box.style.textAlign = "center";
    box.style.boxShadow = "0 0 25px #0f0";

    box.innerHTML = `
        <h2>ðŸ›¡ Hacking System ðŸ›¡</h2>
        <p>Enter your <b>Quotex ID</b> below to access signals.</p>
        <input type="text" id="popupQuotexID" placeholder="Enter Quotex ID" style="width:90%;padding:10px;margin:10px 0;background:#000;border:1px solid #0f0;color:#0f0;border-radius:6px;font-size:14px;">
        <p>Create your account here â†’ <a href="https://broker-qx.pro/sign-up/?lid=1508486" target="_blank" style="color:#0f0;text-decoration:underline;font-weight:bold;">Click Here to Sign Up</a></p>
        <p>Make a deposit of <b>20$</b> to get your license.</p>
        <p>Contact me on Telegram â†’ <a href="https://t.me/traderParvej" target="_blank" style="color:#0f0;text-decoration:underline;font-weight:bold;">@traderParvej</a></p>
        <button id="popupSubmit" style="margin-top:12px;padding:10px 20px;background:linear-gradient(90deg,#00ff0f,#00cc8a);border:none;color:#000;font-weight:bold;border-radius:8px;cursor:pointer;">Submit</button>
        <button id="popupClose" style="margin-top:12px;padding:8px 15px;background:#000;border:1px solid #0f0;color:#0f0;border-radius:8px;cursor:pointer;margin-left:10px;">Close</button>
    `;

    overlay.appendChild(box);
    document.body.appendChild(overlay);

    document.getElementById("popupClose").onclick = () => {
        document.body.removeChild(overlay);
    }

    document.getElementById("popupSubmit").onclick = () => {
        const id = document.getElementById("popupQuotexID").value.trim();
        const licenses = JSON.parse(localStorage.getItem('licenses')||'{}');
        const now = new Date().getTime();
        if(licenses[id] && licenses[id] > now){
            document.body.removeChild(overlay);
            const count = parseInt(document.getElementById('count').value) || 5;
            generateSignals(count);
        } else {
            alert("License invalid or expired! Contact @traderParvej.");
        }
    }
}
</script>
