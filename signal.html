<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Finorix Matrix AI</title>
<style>
    body{
        margin:0;
        background:#060b18;
        font-family:Arial, sans-serif;
        color:white;
        text-align:center;
    }
    h1{
        margin-top:60px;
        font-size:32px;
        cursor:pointer;
    }
    input{
        width:260px;
        padding:10px;
        margin-top:8px;
        border-radius:6px;
        border:none;
        outline:none;
        font-size:16px;
    }
    button{
        margin-top:12px;
        padding:10px 25px;
        background:#1a73e8;
        color:white;
        font-size:17px;
        border:none;
        border-radius:6px;
        cursor:pointer;
    }
    #adminPanel{
        display:none;
        width:90%;
        max-width:450px;
        margin:25px auto;
        padding:20px;
        background:#0d1224;
        border-radius:10px;
        text-align:left;
    }
    #closeAdmin{
        margin-top:15px;
        background:#d43535;
    }
</style>
</head>
<body>

<h1 id="title">Finorix Matrix AI</h1>

<h3>Enter License Key</h3>
<input type="text" id="licenseInput" placeholder="Enter license key">
<br>
<button onclick="checkLicense()">Login</button>

<div id="adminPanel">
    <h2>ADMIN PANEL</h2>
    <p><b>Manage licenses, devices, etc.</b></p>

    <h3>Give New License</h3>
    <input type="text" id="newDevice" placeholder="Device ID">
    <input type="datetime-local" id="newExpiry">

    <button onclick="giveLicense()">Save License</button>

    <button id="closeAdmin" onclick="closeAdmin()">Close Admin Panel</button>
</div>


<script>
let clickCount = 0;
let adminUnlocked = false;

// ---------------------------------------
// ADMIN PANEL OPEN (5 clicks + password)
// ---------------------------------------
document.getElementById("title").addEventListener("click", function(){
    clickCount++;

    if(clickCount >= 5 && !adminUnlocked){
        const pass = prompt("Enter Admin Password:");

        if(pass === "@TraderParvej@"){
            adminUnlocked = true;
            openAdmin();
        }

        clickCount = 0;
    }
});

// ---------------------------------------
// OPEN & CLOSE ADMIN PANEL
// ---------------------------------------
function openAdmin(){
    document.getElementById("adminPanel").style.display = "block";
}
function closeAdmin(){
    document.getElementById("adminPanel").style.display = "none";
}

// ---------------------------------------
// CHECK LICENSE
// ---------------------------------------
function checkLicense(){
    let key = document.getElementById("licenseInput").value.trim();

    let saved = localStorage.getItem("licenses");
    saved = saved ? JSON.parse(saved) : {};

    if(saved[key]){
        let expiry = new Date(saved[key].expiry);
        let now = new Date();

        if(now <= expiry){
            alert("Login Successful!");
            window.location.href = "signal.html";
        } else {
            alert("License Expired!");
        }
    } else {
        alert("Invalid License!");
    }
}

// ---------------------------------------
// GIVE LICENSE (device cannot get new license if old is active)
// ---------------------------------------
function giveLicense(){
    let device = document.getElementById("newDevice").value.trim();
    let expiry = document.getElementById("newExpiry").value;

    if(device === "" || expiry === ""){
        alert("Fill all fields!");
        return;
    }

    let data = localStorage.getItem("licenses");
    data = data ? JSON.parse(data) : {};

    if(data[device]){
        let now = new Date();
        let oldExpiry = new Date(data[device].expiry);

        if(now <= oldExpiry){
            alert("This device already has an active license!");
            return;
        }
    }

    data[device] = {expiry: expiry};
    localStorage.setItem("licenses", JSON.stringify(data));

    alert("License Saved!");
}
</script>

</body>
</html>
